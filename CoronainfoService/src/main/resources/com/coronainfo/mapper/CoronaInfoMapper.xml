<?xml version = "1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd.mybatis-3-mapper.dtd">
<mapper namespace = "com.coronainfo.mapper.CoronaInfoMapper">
    <insert id ="insertCoronaInfo">
        INSERT INTO corona_info (accExamCnt, accExamCompCnt, careCnt, clearCnt, deathCnt, decideCnt, examCnt, resultNegCnt, stateTime)
        VALUES(#{accExamCnt}, #{accExamCompCnt}, #{careCnt}, #{clearCnt}, #{deathCnt}, #{decideCnt}, #{examCnt}, #{resultNegCnt}, #{stateTime});
    </insert>
    <select id ="selectCoronaInfoByDate" resultType = "com.coronainfo.vo.CoronaInfoVO">
        select * from corona_info where stateTime>=str_to_date(#{date}, "%Y-%m-%d") limit 1;
    </select>
    
    <insert id = "insertCoronaSido">
        INSERT INTO corona_sido (deathCnt, defCnt, gubun, incDec, isolClearCnt, createDt, isolIngCnt, localOccCnt, overFlowCnt)
        VALUES(#{deathCnt}, #{defCnt}, #{gubun}, #{incDec}, #{isolClearCnt}, #{createDt}, #{isolIngCnt}, #{localOccCnt}, #{overFlowCnt});
    </insert>
    <select id = "selectCoronaSidoByDate" resultType = "com.coronainfo.vo.CoronaSidoVO">
        select * from corona_sido where date_format(createDt,"%Y-%m-%d") = str_to_date(#{date}, "%Y-%m-%d") and gubun != '합계'
    </select>
    
    <insert id = "insertCoronaAgeGen">
        INSERT INTO corona_age_and_gen (confCase, confCaseRate, createDt, criticalRate, death, deathRate, gubun)
        VALUES(#{confCase}, #{confCaseRate}, #{createDt}, #{criticalRate}, #{death}, #{deathRate}, #{gubun});
    </insert>
    <select id = "selectCoronaAgeByDate" resultType = "com.coronainfo.vo.CoronaAgeAndGenVO">
        select * from corona_age_and_gen where date_format(createDt,"%Y-%m-%d") = str_to_date(#{date}, "%Y-%m-%d") and gubun != '남성' and gubun != '여성';
    </select>
    <select id = "selectCoronaGenByDate" resultType = "com.coronainfo.vo.CoronaAgeAndGenVO">
    select * from corona_age_and_gen where date_format(createDt,"%Y-%m-%d") = str_to_date(#{date}, "%Y-%m-%d") and gubun = '남성' &amp; '여성' and gubun != '0-9';
    </select>
</mapper>